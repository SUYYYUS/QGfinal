<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>学生注册</title>
    <link href="css/StudentSignup.css" rel="stylesheet">
</head>
<body>

<div id="n1">
    <h1>欢迎注册</h1>
    <span>已有帐号？</span> <a href="StudentLogin.html">登录</a>
</div>
<div id="signupDiv" style="height: 350px">
    <form id = "form">
        <h1 id="loginmsg">注册账号</h1>
        <div id="errorMsg" v-model="errorMsg">{{errorMsg}}</div>
        <p class="signup">姓名<input id="studentname" type="text" name="studentname" v-model="Student.studentname"></p>
        <p class="signup">学号<input id="studentid" type="text" name="studentid" v-model="Student.studentid"></p>
        <p class="signup">密码<input  id="password" type="password" name="password" v-model="Student.password"></p>
        <template>
            <p class="signup">年级<el-select v-model="Student.grade" placeholder="请选择">
                <el-option
                        v-for="item in options"
                        :key="item.value"
                        :label="item.label"
                        :value="item.value">
                </el-option>
            </el-select></p>
        </template>

        <p class="signup">QQ<input  id="qq" type="text" name="qq" v-model="Student.qq"></p>
        <p class="signup">个人介绍<input  id="description" type="text" name="description" v-model="Student.description"></p>

        <!--            <p class="signup">性别<input  id="gender" type="text" name="gender" v-model="User.gender"></p>-->

        <el-row>
            <el-button type="primary" @click="signup">注册</el-button>
            <el-button type="primary" @click="login">返回登录</el-button>
        </el-row>

        <form>

</div>

<script src="js/axios-0.18.0.js"></script>
<script src="js/vue.js"></script>
<script src="element-ui/lib/index.js"></script>
<link rel="stylesheet" href="element-ui/lib/theme-chalk/index.css">

<script>
    new Vue({
        el:"#signupDiv",

        data(){

            errorMeg:''

            return{
                Student:{
                    id:'',
                    studentname:'',
                    studentid:'',
                    password:'',
                    grade:'',
                    qq:'',
                    description:'',
                    create_time:'',
                    update_time:'',
                },
                options: [{
                    value: '2023级',
                    label: '2023级'
                }, {
                    value: '2022级',
                    label: '2022级'
                }, {
                    value: '2021级',
                    label: '2021级'
                }, {
                    value: '2020级',
                    label: '2020级'
                }],

            }

        },


        methods:{
            signup(){
                var _this = this;
                console.log(_this.Student);
                axios({
                    method: "post",
                    url:"http://localhost:8080/QGfinal_test_war/Student/studentSignup",
                    data: _this.Student,
                }).then(function (resp) {
                    if(resp.data == "success"){
                        //提示添加成功
                        _this.$message({
                            message: '恭喜你，注册成功啦',
                            type: 'success'
                        });

                    }
                    else if(resp.data == "failed"){
                        _this.errorMsg = "此用户名已存在";
                        _this.User.password = '';
                        //提示添加成功
                        _this.$message({
                            message: '恭喜你，注册失败啦',
                            type: 'warning'
                        });
                    }
                })
            },
            login(){
                location.href = "/QGfinal_test_war/StudentLogin.html";
            },
        },

        // mounted(){
        //
        //     this.adduser(this.User);
        // },

    })
</script>


</body>
</html>